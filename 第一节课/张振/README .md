### 前端全链路优化  

## 当输入一个URL的时候 都经历了哪些？ 有哪些地方可以优化 


```
1.DNS进行域名解析的过程
3.TCP/IP协议
3.http 协议 
4.浏览器解析渲染
```


#### DNS进行域名解析的过程 

DNS(Domain Name System, 域名系统)，作为域名和IP地址相互映射的一个分布式数据库。
当浏览器访问一个域名的时候，需要解析一次DNS，获得对应域名的ip地址。在解析过程中，按照浏览器缓存、系统缓存、路由器缓存、ISP(运营商)DNS缓存、根域名服务器、顶级域名服务器、主域名服务器的顺序，逐步读取缓存，直到拿到IP地址。 

#### 前端优化之DNS Prefetch

DNS Prefetch就是根据浏览器定义的规则，提前解析之后可能会用到的域名，使解析结果缓存到系统缓存中，缩短DNS解析时间，来提高网站的访问速度。

#### 如何使用DNS Prefetch  

现代浏览器在 DNS Prefetch 上做了两项工作：

1.html 源码下载完成后，会解析页面的包含链接的标签，提前查询对应的域名

2.对于访问过的页面，浏览器会记录一份域名列表，当再次打开时，会在 html 下载的同时去解析 DNS


1.自动解析 

Chromium使用超链接的href属性来查找要预解析的主机名。当遇到a标签，Chromium会自动将href中的域名解析为IP地址，这个解析过程是与用户浏览网页并行处理的。但是为了确保安全性，在HTTPS页面中不会自动解析。

2.手动解析 

```
<link rel="dns-prefetch" href="//img.alicdn.com">
```

3.自动解析控制 

当我们希望在HTTPS页面开启自动解析功能时，添加如下标记

```
<meta http-equiv="x-dns-prefetch-control" content="on">

```

当我们希望在HTTP页面关闭自动解析功能时，添加如下标记

```
<meta http-equiv="x-dns-prefetch-control" content="off">

```
4.解决的问题及收益 

DNS Prefetch有效缩短了DNS的解析时间。

如果浏览器最近将一个域名解析为IP地址，所属的操作系统将会缓存，下一次DNS解析时间可以低至0-1ms。 如果结果不在系统本地缓存，则需要读取路由器的缓存，则解析时间的最小值大约为15ms。如果路由器缓存也不存在，则需要读取ISP（运营商）DNS缓存，一般像taobao.com、baidu.com这些常见的域名，读取ISP（运营商）DNS缓存需要的时间在80-120ms，如果是不常见的域名，平均需要200-300ms。一般的网站在运营商这里都能查询的到，所以普遍来说DNS Prefetch可以给一个域名的DNS解析过程带来15-300ms的提升，尤其是一些大量引用很多其他域名资源的网站，提升效果就更加明显了。
Chromium对底层缓存进行了建模，当Chrome浏览器启动的时候，就会自动的快速解析浏览器最近一次启动时记录的前10个域名。所以你经常访问的网址就没有DNS解析的延迟，打开速度更快。 

#### DNS优化如何实现？
   一般域名商或服务器商都会提供免费的DNS服务，然而，很多情况下这些免费的DNS服务器速度较慢，故可做一定优化，具体可从以下几方面
   
  1.增加DNS服务器数量 
  
  2.全国多地分布DNS服务器 
  
  3.识别用户线路反馈相应线路IP 
  
  4.负载均衡 
#### 参考资料 : 
<a href='http://www.admin10000.com/document/2406.html''>DNS解析全过程</a>


